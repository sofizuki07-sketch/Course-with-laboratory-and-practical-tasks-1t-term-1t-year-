# Лабораторная работа №5
## Тема: Файловый ввод-вывод в языке C

### Задача 1: Копирование файла с обработкой ошибок
Напишите программу, которая копирует содержимое одного текстового файла в другой. Программа должна принимать имена исходного и целевого файлов в качестве аргументов командной строки. Реализуйте проверку корректности открытия файлов с использованием `perror`, обработку ошибок чтения/записи и гарантируйте закрытие файлов даже в случае ошибок. Используйте буфер фиксированного размера для эффективного копирования.

### Задача 2: Чтение и анализ CSV-файла
Создайте программу для чтения CSV-файла, содержащего данные о товарах: название, цена, количество. Программа должна подсчитывать общую стоимость всех товаров (цена × количество), находить самый дорогой и самый дешёвый товар, а также вычислять среднюю цену. Реализуйте парсинг строк с разделителями-запятыми, обработку возможных ошибок формата и вывод результатов в читаемом виде.

### Задача 3: Двоичный журнал событий с произвольным доступом
Разработайте систему логирования событий в двоичный файл. Каждое событие представляет собой структуру с полями: метка времени (`time_t`), тип события (целое число), описание (строка фиксированной длины). Реализуйте функции для добавления новых записей в конец файла, чтения записи по номеру с использованием `fseek`, и вывода всех записей за указанный день. Обеспечьте целостность данных при аварийном завершении программы.

### Задача 4: Поиск и замена текста в файле
Напишите программу для поиска и замены подстрок в текстовом файле. Программа должна принимать имя файла, искомую подстроку и строку замены. Создайте временный файл, в который запишется модифицированное содержимое, затем замените исходный файл временным. Учтите, что искомая подстрока может встречаться несколько раз и иметь разную длину с заменяемой строкой. Реализуйте обработку многобайтовых символов.

### Задача 5: Архивирование нескольких файлов в один
Создайте простую систему архивации, которая объединяет несколько файлов в один двоичный файл с заголовком. Для каждого файла в архиве сохраняйте: оригинальное имя, размер, содержимое. Реализуйте функции для создания архива из указанных файлов и извлечения файлов из архива. Используйте структуры для хранения метаданных и обеспечьте возможность восстановления исходной структуры файлов.

---

## Теоретическая справка по теме «Файловый ввод-вывод в C»

### 1. Основные новые понятия темы:

- **Файловый дескриптор/поток(FILE*)** – указатель на структуру, представляющую открытый файл в программе
- **Режимы открытия файла** – "r" (чтение), "w" (запись), "a" (добавление), "rb"/"wb" (двоичный режим)
- **Буферизация ввода-вывода** – механизм временного хранения данных для оптимизации операций с диском
- **Позиция в файле** – текущее место для чтения/записи, управляемое функциями `fseek`, `ftell`
- **Двоичные и текстовые файлы** – различия в обработке символов перевода строки и других служебных символов

### 2. Ключевые изученные элементы языка C:

- Работа с функциями `fopen`, `fclose`, `fread`, `fwrite`, `fgets`, `fputs`
- Использование `fseek` и `ftell` для произвольного доступа к файлам
- Обработка ошибок ввода-вывода с помощью `perror` и проверки возвращаемых значений
- Организация структурированного хранения данных в двоичных файлах
- Создание и использование временных файлов (`tmpfile`, `tmpnam`)

---

### Ключевые моменты для запоминания:
- Всегда проверяйте результат `fopen` на `NULL`
- Закрывайте файлы с помощью `fclose` после завершения работы
- Для двоичных данных используйте режимы "rb"/"wb"
- Функции семейства `fprintf`/`fscanf` работают с файлами аналогично `printf`/`scanf`
- При работе с большими файлами используйте буферизированный ввод-вывод

---

### Практические советы:
- Для текстовых файлов используйте `fgets`/`fputs`, для двоичных – `fread`/`fwrite`
- При обработке ошибок выводите имя проблемного файла
- Тестируйте программы на файлах разного размера, включая пустые и очень большие
